/**
 * headless-calendar-fns v0.0.1
 * Copyright 2018-2022 Nick Graffis <hi@nickgraffis.me>
 */

"use strict";const e=Object.assign||function(e){for(var n,t=1;t<arguments.length;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e};var n;function t(t,r,a,o,u){var s;void 0===o&&(o={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0});var l=[],d=7,w=0,c=1;(null==o?void 0:o.daysInWeek)&&("number"==typeof o.daysInWeek?d=o.daysInWeek+1:"string"==typeof o.daysInWeek&&("weekends"===o.daysInWeek?(d=7,w=0,c=6):(d=6,w=1))),(null==o?void 0:o.startOfWeek)&&("weekends"!==(null==o?void 0:o.daysInWeek)&&"weekdays"!==(null==o?void 0:o.daysInWeek)||console.warn("setting startOfWeek with daysInWeek: weekends or weekdays can have wild results!"),w=o.startOfWeek);for(var v=(null==o?void 0:o.timeZone)?new Date((new Date).toLocaleString("en-US",{timeZone:o.timeZone})):new Date,y=function(d){var w=function(e,n,t,r){var i=new Date(r,t,1).getDay();return new Date(r,t,7*e+n-(0===i?6:i-1))}(t,d,r,a),c={};null==u||u.forEach((function(t){t.views.includes(n.day)&&(c=e(e({},t.fn(w)),c))})),l.push(e(e(e({},(null==o?void 0:o.includeHours)&&{hours:i(w,o,u)}),{date:(null==o?void 0:o.format)?new Date(w).toLocaleString((null===(s=null==o?void 0:o.format)||void 0===s?void 0:s.locales)||"en-US",e({},null==o?void 0:o.format)):w.toISOString().split("T")[0],isToday:w.getDate()===v.getDate()&&w.getMonth()===v.getMonth()&&w.getFullYear()===v.getFullYear(),isWeekend:0===w.getDay()||6===w.getDay(),day:(null==o?void 0:o.daysOfWeek)?Array.isArray(o.daysOfWeek)?o.daysOfWeek[w.getDay()]:"string"==typeof o.daysOfWeek&&["long","short","narrow"].includes(o.daysOfWeek)?w.toLocaleDateString("en-US",{weekday:o.daysOfWeek}):void 0:(o.daysOfWeek,w.getDay()),week:t,month:r,year:a}),c))},f=w;f<d;f+=c)y(f);return l}function r(t,r,i,a){for(var o,u=[],s=function(s){var l=new Date(r.getTime());l.setHours(t,s);var d={};null==a||a.forEach((function(t){t.views.includes(n.minute)&&(d=e(e({},t.fn(l)),d))})),u.push(e({date:(null==i?void 0:i.format)?new Date(l).toLocaleString((null===(o=null==i?void 0:i.format)||void 0===o?void 0:o.locales)||"en-US",e({},null==i?void 0:i.format)):r.toISOString().split("T")[0],minute:s,hour:t,day:l.getDate(),month:l.getMonth(),year:l.getFullYear(),isCurrentMinute:l.getMinutes()===(new Date).getMinutes()},d))},l=0;l<60;l++)s(l);return u}function i(t,i,a){var o;void 0===i&&(i={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0});var u=[],s=0,l=24;(null==i?void 0:i.startOfDay)&&(s=i.startOfDay),(null==i?void 0:i.hoursInDay)&&(l=s+i.hoursInDay+1);for(var d=function(s){var l={};null==a||a.forEach((function(r){r.views.includes(n.hour)&&(l=e(e({},r.fn(new Date(t.getFullYear(),t.getMonth(),t.getDate(),s))),l))}));var d=(null==i?void 0:i.timeZone)?new Date((new Date).toLocaleString("en-US",{timeZone:i.timeZone})):new Date,w=s===d.getHours(),c=e(e(e({date:(null==i?void 0:i.format)?new Date(t).toLocaleString((null===(o=null==i?void 0:i.format)||void 0===o?void 0:o.locales)||"en-US",e({},null==i?void 0:i.format)):t.toISOString().split("T")[0]},(null==i?void 0:i.includeMinutes)&&{minutes:r(s,t,i,a)}),{hour:s,day:t.getDate(),month:t.getMonth(),year:t.getFullYear(),isCurrentHour:w}),l);u.push(c)},w=s;w<l;w++)d(w);return u}function a(r,i,a,o){void 0===a&&(a={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0});for(var u=[],s=function(e,n){var t=new Date(n,e,1).getDay(),r=new Date(n,e+1,0).getDate();return Math.ceil((r+t)/7)}(r,i),l=function(s){var l={};null==o||o.forEach((function(t){t.views.includes(n.week)&&(l=e(e({},t.fn(new Date(i,r),s)),l))})),u.push(e(e(e({},a.includeDays&&{days:t(s,r,i,a,o)}),{week:s,year:i,month:r}),l))},d=0;d<s;d++)l(d);return u}function o(t,r,i){void 0===r&&(r={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0});for(var o=[],u=function(u){var s={};null==i||i.forEach((function(r){r.views.includes(n.month)&&(s=e(e({},r.fn(new Date(t,u))),s))})),o.push(e(e(e({},r.includeWeeks&&{weeks:a(u,t,r,i)}),{month:u,year:t}),s))},s=0;s<12;s++)u(s);return o}!function(e){e.year="year",e.month="month",e.week="week",e.day="day",e.hour="hour",e.minute="minute"}(n||(n={})),module.exports=function(e){var u=e.view,s=e.year,l=e.month,d=e.week,w=e.day,c=e.hour,v=e.plugins;switch(e.includeWeeks=e.includeWeeks||!0,e.includeDays=e.includeDays||!0,e.includeHours=e.includeHours||!1,e.includeMinutes=e.includeMinutes||!1,u){case n.year:return{view:u,current:{view:u,months:o(s,e,v)},prev:{view:u,months:o(s-1,e,v)},next:{view:u,months:o(s+1,e,v)}};case n.month:if(!l||!s)throw new Error("month and year is required, when creating a matrix for month view");return{view:u,current:{view:u,weeks:a(l,s,e,v)},prev:{view:u,weeks:a(l-1,s,e,v)},next:{view:u,weeks:a(l+1,s,e,v)}};case n.week:if(!d||!l||!s)throw new Error("week, month, year is required, when creating a matrix for week view");return{view:u,current:{view:u,days:t(d,l,s,e,v)},prev:{view:u,days:t(d-1,l,s,e,v)},next:{view:u,days:t(d+1,l,s,e,v)}};case n.day:if(!w||!l||!s)throw new Error("day, month, year is required, when creating a matrix for day view");return{view:u,current:{view:u,hours:i(new Date(s,l,w),e,v)},prev:{view:u,hours:i(new Date(s,l,w-1),e,v)},next:{view:u,hours:i(new Date(s,l,w+1),e,v)}};case n.hour:if(!(c&&w&&l&&s))throw new Error("hour, day, month, year is required, when creating a matrix for hour view");return{view:u,current:{view:u,minutes:r(c,new Date(s,l,w),e,v)},prev:{view:u,minutes:r(c-1,new Date(s,l,w),e,v)},next:{view:u,minutes:r(c+1,new Date(s,l,w),e,v)}};default:throw new Error("Invalid view, must be one of: year, month, week, day, hour")}};
