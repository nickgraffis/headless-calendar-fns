(function(h,D){typeof exports=="object"&&typeof module!="undefined"?module.exports=D():typeof define=="function"&&define.amd?define(D):(h=typeof globalThis!="undefined"?globalThis:h||self,h.createMatrix=D())})(this,function(){"use strict";function h(a,r){const e=new Date(r,a,1).getDay(),c=new Date(r,a+1,0).getDate();return Math.ceil((c+e)/7)}function D(a,r,t,e){const d=new Date(e,t,1).getDay(),f=d===0?6:d-1,w=a*7+r-f;return new Date(e,t,w)}function m(a,r,t,e,c){var I;const d=[];let f=7,u=0,w=1;e!=null&&e.daysInWeek&&(typeof e.daysInWeek=="number"?f=e.daysInWeek+1:typeof e.daysInWeek=="string"&&(e.daysInWeek==="weekends"?(f=7,u=0,w=6):(f=6,u=1))),e!=null&&e.startOfWeek&&(((e==null?void 0:e.daysInWeek)==="weekends"||(e==null?void 0:e.daysInWeek)==="weekdays")&&console.warn("setting startOfWeek with daysInWeek: weekends or weekdays can have wild results!"),u=e.startOfWeek);let l=e!=null&&e.timeZone?new Date(new Date().toLocaleString("en-US",{timeZone:e.timeZone})):new Date;for(let y=u;y<f;y=y+w){const n=D(a,y,r,t);let O={};c==null||c.forEach(x=>{x.views.includes("day")&&(O={...x.fn(n),...O})});let k=n.getDay();e!=null&&e.daysOfWeek?Array.isArray(e.daysOfWeek)?k=e.daysOfWeek[n.getDay()]:typeof e.daysOfWeek=="string"&&["long","short","narrow"].includes(e.daysOfWeek)&&(k=n.toLocaleDateString("en-US",{weekday:e.daysOfWeek})):(e.daysOfWeek,k=n.getDay()),d.push({...(e==null?void 0:e.includeHours)&&{hours:g(n,e,c)},date:e!=null&&e.format?new Date(n).toLocaleString(((I=e==null?void 0:e.format)==null?void 0:I.locales)||"en-US",{...e==null?void 0:e.format}):n.toISOString().split("T")[0],isToday:n.getDate()===l.getDate()&&n.getMonth()===l.getMonth()&&n.getFullYear()===l.getFullYear(),isWeekend:n.getDay()===0||n.getDay()===6,day:k,week:a,month:r,year:t,...O})}return d}function W(a,r,t,e){var d;const c=[];for(let f=0;f<60;f++){const u=new Date(r.getTime());u.setHours(a,f);let w={};e==null||e.forEach(l=>{l.views.includes("minute")&&(w={...l.fn(u),...w})}),c.push({date:t!=null&&t.format?new Date(u).toLocaleString(((d=t==null?void 0:t.format)==null?void 0:d.locales)||"en-US",{...t==null?void 0:t.format}):r.toISOString().split("T")[0],minute:f,hour:a,day:u.getDate(),month:u.getMonth(),year:u.getFullYear(),isCurrentMinute:u.getMinutes()===new Date().getMinutes(),...w})}return c}function g(a,r={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0},t){var f;let e=[],c=0,d=24;r!=null&&r.startOfDay&&(c=r.startOfDay),r!=null&&r.hoursInDay&&(d=c+r.hoursInDay+1);for(let u=c;u<d;u++){let w={};t==null||t.forEach(n=>{n.views.includes("hour")&&(w={...n.fn(new Date(a.getFullYear(),a.getMonth(),a.getDate(),u)),...w})});let l=r!=null&&r.timeZone?new Date(new Date().toLocaleString("en-US",{timeZone:r.timeZone})):new Date,I=u===l.getHours(),y={date:r!=null&&r.format?new Date(a).toLocaleString(((f=r==null?void 0:r.format)==null?void 0:f.locales)||"en-US",{...r==null?void 0:r.format}):a.toISOString().split("T")[0],...(r==null?void 0:r.includeMinutes)&&{minutes:W(u,a,r,t)},hour:u,day:a.getDate(),month:a.getMonth(),year:a.getFullYear(),isCurrentHour:I,...w};e.push(y)}return e}function S(a,r){const e=new Date().getDate(),d=new Date(r,a,1).getDay(),f=e-d;return Math.ceil(f/7)}function M(a,r,t={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0},e){const c=[],d=h(a,r);for(let f=0;f<d;f++){let u={};e==null||e.forEach(w=>{w.views.includes("week")&&(u={...w.fn(new Date(r,a),f),...u})}),c.push({...t.includeDays&&{days:m(f,a,r,t,e)},week:f,year:r,month:a,isCurrentWeek:f===S(a,r),...u})}return c}function s(a,r,t){const e=[];for(let c=0;c<12;c++){let d={};t==null||t.forEach(f=>{f.views.includes("month")&&(d={...f.fn(new Date(a,c)),...d})}),e.push({...r.includeWeeks&&{weeks:M(c,a,r,t)},month:c,year:a,isCurrentMonth:c===new Date().getMonth(),...d})}return e}function v(a,r,t){let e={};return t==null||t.forEach(c=>{c.views.includes("year")&&(e={...c.fn(new Date(a)),...e})}),{...r.includeMonths&&{months:s(a,r,t)},year:a,isCurrentYear:a===new Date().getFullYear(),...e}}function E(a){const{view:r,year:t,month:e,week:c,day:d,hour:f,plugins:u}=a;switch(a.includeMonths=a.includeMonths||!0,a.includeWeeks=a.includeWeeks||!0,a.includeDays=a.includeDays||!0,a.includeHours=a.includeHours||!1,a.includeMinutes=a.includeMinutes||!1,r){case"year":return{view:r,prev:{view:"year",year:v(t-1,a,u)},current:{view:"year",year:v(t,a,u)},next:{view:"year",year:v(t+1,a,u)}};case"month":return{view:r,current:{view:r,months:s(t,a,u)},prev:{view:r,months:s(t-1,a,u)},next:{view:r,months:s(t+1,a,u)}};case"week":if(!e&&e!==0||!t)throw new Error("month and year is required, when creating a matrix for month view");return{view:r,current:{view:r,weeks:M(e,t,a,u)},prev:{view:r,weeks:M(e-1,t,a,u)},next:{view:r,weeks:M(e+1,t,a,u)}};case"day":if(!c||!e||!t)throw new Error("week, month, year is required, when creating a matrix for week view");return{view:r,current:{view:r,days:m(c,e,t,a,u)},prev:{view:r,days:m(c-1,e,t,a,u)},next:{view:r,days:m(c+1,e,t,a,u)}};case"hour":if(!d||!e||!t)throw new Error("day, month, year is required, when creating a matrix for day view");return{view:r,current:{view:r,hours:g(new Date(t,e,d),a,u)},prev:{view:r,hours:g(new Date(t,e,d-1),a,u)},next:{view:r,hours:g(new Date(t,e,d+1),a,u)}};case"minute":if(!f||!d||!e||!t)throw new Error("hour, day, month, year is required, when creating a matrix for hour view");return{view:r,current:{view:r,minutes:W(f,new Date(t,e,d),a,u)},prev:{view:r,minutes:W(f-1,new Date(t,e,d),a,u)},next:{view:r,minutes:W(f+1,new Date(t,e,d),a,u)}};default:throw new Error("Invalid view, must be one of: year, month, week, day, hour")}}return E});
