(function(h,D){typeof exports=="object"&&typeof module!="undefined"?module.exports=D():typeof define=="function"&&define.amd?define(D):(h=typeof globalThis!="undefined"?globalThis:h||self,h.createMatrix=D())})(this,function(){"use strict";function h(a,r){const e=new Date(r,a,1).getDay(),f=new Date(r,a+1,0).getDate();return Math.ceil((f+e)/7)}function D(a,r,t,e){const d=new Date(e,t,1).getDay(),c=d===0?6:d-1,n=a*7+r-c;return new Date(e,t,n)}function m(a,r,t,e,f){var I;const d=[];let c=7,u=0,n=1;e!=null&&e.daysInWeek&&(typeof e.daysInWeek=="number"?c=e.daysInWeek+1:typeof e.daysInWeek=="string"&&(e.daysInWeek==="weekends"?(c=7,u=0,n=6):(c=6,u=1))),e!=null&&e.startOfWeek&&(((e==null?void 0:e.daysInWeek)==="weekends"||(e==null?void 0:e.daysInWeek)==="weekdays")&&console.warn("setting startOfWeek with daysInWeek: weekends or weekdays can have wild results!"),u=e.startOfWeek);let y=e!=null&&e.timeZone?new Date(new Date().toLocaleString("en-US",{timeZone:e.timeZone})):new Date;for(let l=u;l<c;l=l+n){const w=D(a,l,r,t);let O={};f==null||f.forEach(x=>{x.views.includes("day")&&(O={...x.fn(w,x.args),...O})});let k=w.getDay();e!=null&&e.daysOfWeek?Array.isArray(e.daysOfWeek)?k=e.daysOfWeek[w.getDay()]:typeof e.daysOfWeek=="string"&&["long","short","narrow"].includes(e.daysOfWeek)&&(k=w.toLocaleDateString("en-US",{weekday:e.daysOfWeek})):(e.daysOfWeek,k=w.getDay()),d.push({...(e==null?void 0:e.includeHours)&&{hours:s(w,e,f)},date:e!=null&&e.format?new Date(w).toLocaleString(((I=e==null?void 0:e.format)==null?void 0:I.locales)||"en-US",{...e==null?void 0:e.format}):w.toISOString().split("T")[0],isToday:w.getDate()===y.getDate()&&w.getMonth()===y.getMonth()&&w.getFullYear()===y.getFullYear(),isWeekend:w.getDay()===0||w.getDay()===6,day:k,week:a,month:r,year:t,...O})}return d}function W(a,r,t,e){var d;const f=[];for(let c=0;c<60;c++){const u=new Date(r.getTime());u.setHours(a,c);let n={};e==null||e.forEach(y=>{y.views.includes("minute")&&(n={...y.fn(u,y.args),...n})}),f.push({date:t!=null&&t.format?new Date(u).toLocaleString(((d=t==null?void 0:t.format)==null?void 0:d.locales)||"en-US",{...t==null?void 0:t.format}):r.toISOString().split("T")[0],minute:c,hour:a,day:u.getDate(),month:u.getMonth(),year:u.getFullYear(),isCurrentMinute:u.getMinutes()===new Date().getMinutes(),...n})}return f}function s(a,r={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0},t){var c;let e=[],f=0,d=24;r!=null&&r.startOfDay&&(f=r.startOfDay),r!=null&&r.hoursInDay&&(d=f+r.hoursInDay+1);for(let u=f;u<d;u++){let n={};t==null||t.forEach(w=>{w.views.includes("hour")&&(n={...w.fn(new Date(a.getFullYear(),a.getMonth(),a.getDate(),u),w.args),...n})});let y=r!=null&&r.timeZone?new Date(new Date().toLocaleString("en-US",{timeZone:r.timeZone})):new Date,I=u===y.getHours(),l={date:r!=null&&r.format?new Date(a).toLocaleString(((c=r==null?void 0:r.format)==null?void 0:c.locales)||"en-US",{...r==null?void 0:r.format}):a.toISOString().split("T")[0],...(r==null?void 0:r.includeMinutes)&&{minutes:W(u,a,r,t)},hour:u,day:a.getDate(),month:a.getMonth(),year:a.getFullYear(),isCurrentHour:I,...n};e.push(l)}return e}function S(a,r){const e=new Date().getDate(),d=new Date(r,a,1).getDay(),c=e-d;return Math.ceil(c/7)}function g(a,r,t={includeWeeks:!0,includeDays:!0,includeHours:!0,includeMinutes:!0},e){const f=[],d=h(a,r);for(let c=0;c<d;c++){let u={};e==null||e.forEach(n=>{n.views.includes("week")&&(u={...n.fn(new Date(r,a),n.args,c),...u})}),f.push({...t.includeDays&&{days:m(c,a,r,t,e)},week:c,year:r,month:a,isCurrentWeek:c===S(a,r),...u})}return f}function M(a,r,t){const e=[];for(let f=0;f<12;f++){let d={};t==null||t.forEach(c=>{c.views.includes("month")&&(d={...c.fn(new Date(a,f),c.args),...d})}),e.push({...r.includeWeeks&&{weeks:g(f,a,r,t)},month:f,year:a,isCurrentMonth:f===new Date().getMonth(),...d})}return e}function v(a,r,t){let e={};return t==null||t.forEach(f=>{f.views.includes("year")&&(e={...f.fn(new Date(a),f.args),...e})}),{...r.includeMonths&&{months:M(a,r,t)},year:a,isCurrentYear:a===new Date().getFullYear(),...e}}function E(a){var n;const{view:r,year:t,month:e,week:f,day:d,hour:c,plugins:u}=a;if(a.includeMonths=a.includeMonths||!0,a.includeWeeks=a.includeWeeks||!0,a.includeDays=a.includeDays||!0,a.includeHours=a.includeHours||!1,a.includeMinutes=a.includeMinutes||!1,(n=a==null?void 0:a.plugins)!=null&&n.some(y=>y==null?void 0:y.load))for(const y of a.plugins)y.load;switch(r){case"year":return{view:r,prev:{view:"year",year:v(t-1,a,u)},current:{view:"year",year:v(t,a,u)},next:{view:"year",year:v(t+1,a,u)}};case"month":return{view:r,current:{view:r,months:M(t,a,u)},prev:{view:r,months:M(t-1,a,u)},next:{view:r,months:M(t+1,a,u)}};case"week":if(!e&&e!==0||!t)throw new Error("month and year is required, when creating a matrix for month view");return{view:r,current:{view:r,weeks:g(e,t,a,u)},prev:{view:r,weeks:g(e-1,t,a,u)},next:{view:r,weeks:g(e+1,t,a,u)}};case"day":if(!f||!e||!t)throw new Error("week, month, year is required, when creating a matrix for week view");return{view:r,current:{view:r,days:m(f,e,t,a,u)},prev:{view:r,days:m(f-1,e,t,a,u)},next:{view:r,days:m(f+1,e,t,a,u)}};case"hour":if(!d||!e||!t)throw new Error("day, month, year is required, when creating a matrix for day view");return{view:r,current:{view:r,hours:s(new Date(t,e,d),a,u)},prev:{view:r,hours:s(new Date(t,e,d-1),a,u)},next:{view:r,hours:s(new Date(t,e,d+1),a,u)}};case"minute":if(!c||!d||!e||!t)throw new Error("hour, day, month, year is required, when creating a matrix for hour view");return{view:r,current:{view:r,minutes:W(c,new Date(t,e,d),a,u)},prev:{view:r,minutes:W(c-1,new Date(t,e,d),a,u)},next:{view:r,minutes:W(c+1,new Date(t,e,d),a,u)}};default:throw new Error("Invalid view, must be one of: year, month, week, day, hour")}}return E});
